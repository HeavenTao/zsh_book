## 源代码和开发流程

tmux 是 OpenBSD 基础系统的一部分，OpenBSD CVS 是主要的源代码
仓库：

https://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/tmux/

GitHub 保存着可移植的 tmux 版本。有一些小的差异，
主要是为了可移植性。

对主 tmux 代码的代码更改提交到 OpenBSD，然后脚本
每隔几小时自动将任何新提交应用到 GitHub 仓库。

使用 GitHub PR 开发和提交代码更改是可以的，但最终
形式将是应用到 OpenBSD CVS 的补丁文件。

## 发布

tmux 目前大约每六个月发布一个新版本 - 与 OpenBSD 相同
的时间表，大约在 5 月和 10 月。这意味着 GitHub
发布的代码与 OpenBSD 发布的代码大致相同（但不一定
完全相同）。

发布过程包括一个分支，从中生成一个或多个发布
候选版本进行测试，直到最终发布并
删除分支。

## 代码贡献

以下是一份待处理的功能请求或未来开发说明的列表。
它们大致按实现难度分为三个部分。如果有 GitHub 问题，则其编号显示在
括号中。

在开始工作之前，特别是对于较大的
项目，值得联系一下，以避免任何重复劳动。

### 文档

- 维基上的入门指南需要为 3.2 及更高版本更新：

  * 弹出窗口

  * 在树模式下使用标记窗格

  * 扩展键文档的更改

- 高级使用指南未完成，还需要为 3.2 及更高版本添加这些内容：

  * %local

  * terminal-features

### 小事

- ([#4357](https://github.com/tmux/tmux/issues/4357)) 使 `?` 或 `h` 在选择模式下显示
  键绑定。

- ([#4127](https://github.com/tmux/tmux/issues/4127)) 支持像 OSC 10 和 11 一样从外部终端请求 OSC 12。

- ([#3488](https://github.com/tmux/tmux/issues/3488)) 在只读模式下允许进入和
  在复制模式下滚动。

- ([#3466](https://github.com/tmux/tmux/issues/3466)) 在适当的地方接受 ANSI 颜色和
  属性序列用于样式。

- ([#2854](https://github.com/tmux/tmux/issues/2854)) 添加一个 `monitor-input`
  选项，类似于 `monitor-activity`，但仅在窗格未看到
  任何用户输入时触发，而不是所有类型的活动。

- ([#3114](https://github.com/tmux/tmux/issues/3114)) 当配置了多个状态行时，允许提示符出现在
  不同的状态行上。

- ([#3159](https://github.com/tmux/tmux/issues/3159)) 在复制模式下将光标居中的键。

- ([#3061](https://github.com/tmux/tmux/issues/3061)) 格式修饰符指定服务器、会话、窗口、窗格选项，以允许具有相同名称的用户选项。

- ([#3047](https://github.com/tmux/tmux/issues/3047)) 将目标扩展为
  格式。这应该默认完成还是需要前缀（可能是前导
  `+` 或只是查找 `#{`）？

- ([#3074](https://github.com/tmux/tmux/issues/3074)) 用于设置在窗格右上角显示的文本的选项
  与 display-panes 一起显示。

- 如果菜单项可以以 + 为前缀（像 - 一样表示
  禁用），这意味着选择菜单项时不应关闭菜单，
  而是应重新生成项文本（或所有项）。这意味着
  可以通过让项切换选项来实现切换项，该选项
  导致其文本发生变化。

- ([#2953](https://github.com/tmux/tmux/issues/2953)) 调整大小时保持菜单打开。

- ([#2840](https://github.com/tmux/tmux/issues/2840)) 一种切换行
  选择的方式，如 `rectangle-toggle`。

- ([#2766](https://github.com/tmux/tmux/issues/2766)) 一个标志用于 select-window
  创建窗口，或用于 new-window 进行选择。

- ([#2601](https://github.com/tmux/tmux/issues/2601)) 一种处理重复
  窗口目标的方法（选择 MRU？）。不确定是否应该默认或可选。

- ([#2346](https://github.com/tmux/tmux/issues/2346)) 添加一个标志到
  kill-session 以杀死会话组，也许 rename-session 重命名
  一个。

- ([#2671](https://github.com/tmux/tmux/issues/2671)) 添加一个 `window-size
  manual-or-smallest`，仅在没有更小
  客户端时使用手动大小。

- 当在状态行上不需要 -t= 用于 select-window 时
  仍然需要它，这很烦人。

- 许多不使用 CMD_AFTERHOOK 的命令缺少 "After" 钩子。

- 复制模式中的命令用于切换选择。

- 最好能有更多的预设布局。

- 在 emacs 中光标移动会取消增量搜索，tmux 应该以
  相同的方式工作。

- ([#2205](https://github.com/tmux/tmux/issues/2205)) 在复制模式中，应添加
  带正则表达式的增量搜索（新命令）。

- 在为控制模式排队通知时，无需为除附加会话之外的会话排队
  会话通知。同样适用于某些窗口通知。

- ([#3139](https://github.com/tmux/tmux/issues/3139)) 一个选项用于更改
  在复制模式（或任何模式？）下的光标样式和颜色。

- 在复制模式中，刷新（r）将更新内容但不会移动滚动
  位置，因此文本似乎会跳动。最好也移动
  位置，这样就不会有明显的移动。

- 复制模式中的切换以自动刷新，要么在添加新输出时
  - 带有某种时间限制，例如最多每秒一次 - 要么如果
  这很棘手，就每秒一次。

### 中等事情

- ([#4269](https://github.com/tmux/tmux/issues/4269)) 支持模式 2031
  颜色方案通知。

- ([#3655](https://github.com/tmux/tmux/issues/3655)) 在弹出窗口打开后更改弹出窗口
  样式的能力。

- ([#3503](https://github.com/tmux/tmux/issues/3503)) 通过
  鼠标拖动移动窗格或窗口。

- (#[3342](https://github.com/tmux/tmux/issues/3242)) 在复制模式下同步
  两个窗格滚动的能力。

- (#[3258](https://github.com/tmux/tmux/issues/3258)) 服务器范围的最后
  使用的窗格（和窗口？）列表和选择模式。

- (#[3166](https://github.com/tmux/tmux/issues/3166)) 一种在复制模式下编号匹配项的方法
  以便轻松选择它们，以及为有用内容编号的默认键。

- 更多地将命令作为自己的对象使用：

  - 从 list-keys 等漂亮地打印命令。

  - 将命令存储在选项中（这样也可以漂亮地打印）。选项
    如果不与表绑定会更好，因此选项树
    允许任何选项为任何类型，并且 set-option 进行验证。还有
    如果数组索引可以是字符串。

- ([#3036](https://github.com/tmux/tmux/issues/3036)) 选择模式是否可以显示
  多列？

- ([#2484](https://github.com/tmux/tmux/issues/2797)) 突出显示传入文本。

- 允许将焦点放回窗格，同时保持弹出窗口打开，然后回到
  弹出窗口。问题：如果窗格被弹出窗口完全遮挡怎么办？

- 键表超时和在超时发生时触发的键绑定，使用
  格式中的前一个键或其他方式，将允许绑定 C-b 1 0 到窗口
  10，同时保持 C-b 1 用于窗口 1。

- ([#2537](https://github.com/tmux/tmux/issues/2537)) 复制模式应尝试
  在重绘时让终端自然换行，以便终端
  行复制效果更好。这只能在终端与进入复制模式时
  宽度相同时发生。重绘区域会
  困难 - 必须在换行前重绘行？也许写入
  复制模式屏幕可以使用 grid_reader？

- ([#2495](https://github.com/tmux/tmux/issues/2495)) 每会话窗口
  选项。

- ([#2499](https://github.com/tmux/tmux/issues/2499)) &
  ([#2512](https://github.com/tmux/tmux/issues/2512)) 添加一种方法让
  command-prompt、confirm-before 以及可能的 choose-tree 和类似命令将
  选择打印到 stdout。选项是 1）添加标志来执行此操作（如 display-message
  -p）或 2）允许 display-message -p 在用作选择命令时工作。

- 每行网格时间跟踪及其在复制模式和其他地方的使用？

- ([#2354](https://github.com/tmux/tmux/issues/2354)) 复制模式下单词和行的
  样式。

- 将活动窗格标志扩展到窗口，以便客户端可以拥有独立的
  当前窗口。这可以类似于窗格的工作方式，但可能
  更复杂。这个想法是摆脱会话组。

- 自定义模式：
  1) 将选项或标记选项导出到文件的方法；
  2) 类似于缓冲区模式中的 `e` 键，在编辑器弹出窗口中编辑选项值或键命令；
  3) 添加新用户选项的方法；
  4) 添加新键绑定的方法；
  5) 在标题上按 'd' 应将整个键表恢复为默认值。

- unbind -d 标志将键绑定恢复为默认值，使用 -a 恢复所有。

- 在复制模式中 - 底部应该是最后使用的行吗？必须
  将光标移动一大段空白空间可能很烦人。最好在底部
  画一条线（已经有代码了）并防止光标
  移动到它下面。

- 命令提示符的补全可以更聪明：它可以识别
  命令并有一些方法来描述它们的参数，例如只
  为 set-option 补全选项和为 select-layout 补全布局；它可以在 -t 后补全带空格和不带空格的；它可以补全
  特殊目标如 {left}；它可以补全窗格以及窗口。
  可能还有很多其他事情。

- 在 tmux 本身内支持 DECSLRM 边距。

- 应该记住在使用 select-layout 之前的最后一个布局，并且
  不带参数的 select-layout 应该包含它，因此 C-Space 可以在
  预设布局中循环。还需要一个单独的标志或布局名称来
  直接恢复它。或者如何建立一个布局历史和一种返回的方法？菜单？

- 最后一个窗格是否应该像窗口一样堆叠？

- wait-for 可以做更多事情，例如能够等待窗格退出或
  关闭（可以以某种方式使用现有的通知代码）。还需要一个
  超时标志或在信号上停止等待。

- ([#1784](https://github.com/tmux/tmux/issues/1784)) 一种禁用行
  换行但保留任何修剪内容的方法（因此如果窗格
  变大可以查看）。

- 在树模式下移动、连接和重新组织窗格、窗口和会话应该
  更容易。这应该使用标记窗格而不是将其
  与标记混合。也许有键可以在不离开树模式的情况下断开/连接/移动？
  拖动也会很好。

- 使命令提示符能够占用多行。

- ([#918](https://github.com/tmux/tmux/issues/918)) 一种指定当一个窗格
  被杀死时如何合并窗格的方法。可能是 kill-pane 的一个选项。

- 允许多个目标，要么使用多个 -t，要么给出一个模式，要么两者兼有。

- 能够记住复制模式中的位置并在再次进入时回到
  同一位置会很好。如果窗格
  滚动，这将如何工作？用鼠标进入呢？

- 最好有命令在复制模式下通过
  多次复制来构建粘贴缓冲区。它需要在某处显示正在进行的工作
  （左下角？）并有一个命令添加文本块和一个
  命令删除最后一个块和一个命令清除。

- ([#1868](https://github.com/tmux/tmux/issues/1868)) 仅垂直缩放。

- ([#1774](https://github.com/tmux/tmux/issues/1774)) 调整窗格大小应该
  移动到父单元格并调整其大小，如果这允许窗格
  变得更接近所要求的大小。

- ([#3753](https://github.com/tmux/tmux/issues/3753)) 改进 SIXEL 占位符。

- ([#4236](https://github.com/tmux/tmux/issues/4236)) 完全关闭窗格
  边框的选项。

### 大事

- 更一致的命令处理（以破坏所有配置为代价）；

  - 给其他命令的命令都在解析时立即解析，
    基本上它们必须是 {} 或字符串被当作 {} 处理。所以
    if-shell 和朋友永远不会获得字符串参数，只有命令参数。

  - 解析器将字符串参数标记为 " 或 '。

  - 在执行命令之前，触发回调以获取格式树，
    然后每个 " 参数都有格式扩展（其他内容可以同时扩展，如 \n，这将简化解析器）。

  - %% 扩展将保持为第二个扩展步骤，它也可以仅应用于 " 参数。

  - 所有 -F 标志和内联格式扩展都成为无操作或被删除。

  - 选项需要支持命令作为用户选项和钩子的本机参数。这可以在不破坏任何向后
    兼容性的情况下完成。

  - command-alias 被其他东西替换，其中名称和命令
    分别给出，因此命令可以预先解析（更像一个
    函数）。需要在执行时扩展相当于 shell 的参数访问器，如 $1 和
    "$@"。

  - 我认为需要保留某种执行类型解析方式，相当于 eval - 也许 run -C 保持这样。

- 更好的布局。例如，如果它们由提示驱动
  而不是固定位置，并且可以在
  调整大小/分割/杀死后自动重新应用，那会很好。可以使用窗格选项。

- ([#1269](https://github.com/tmux/tmux/issues/1269)) 将网格存储在
  块中。可以用于按需重新排版。最好重新审视 history-limit 的工作方式 - 作为全局限制而不是每个
  窗格是否更好？

- ([#2449](https://github.com/tmux/tmux/issues/2449)) 将窗格链接到多个
  窗口中。

- ([#44](https://github.com/tmux/tmux/issues/44)) &
  ([#1613](https://github.com/tmux/tmux/issues/1613)) 支持 SIXEL。