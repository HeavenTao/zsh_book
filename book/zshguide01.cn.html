<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Chapter1</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<ul>
<li><a href="zshguide.html">目录</a></li>
<li><a href="zshguide02.html">下一章</a></li>
</ul>
<hr />
<p>[]{#intro}[]{#l1}</p>
<h1 id="第一章简短介绍"><a class="header" href="#第一章简短介绍">第一章：简短介绍</a></h1>
<p>Z-Shell，简称 <code>zsh</code>，是 UNIX 系统的一个命令解释器，用 UNIX 的行话来说，就是一个 <code>shell</code>，因为它包裹着你使用的命令。但远不止于此，zsh 是一个特别强大的 shell --- 而且它是免费的，并处于定期维护中 --- 拥有许多交互式功能，让你能以最少的麻烦完成最多的工作。当然，为此你需要知道这个 shell 能做什么以及如何做，而这正是本指南的目的。</p>
<p>最基本的基础：我将假设你能够访问一个 UNIX 系统，否则本文档的其余部分对你来说没什么用。你也可以通过安装 Cygwin 在 Windows 下使用 zsh，Cygwin 为程序提供了一个类 UNIX 的环境 --- 鉴于标准 Windows 命令解释器的弱点，这样做是件好事。有一些旧版本的 zsh 被移植到了 Windows 上，可以本地运行，即无需 UNIX 环境，尽管它们在某些方面的行为略有不同，我不会进一步讨论它们。</p>
<p>我还将假设你具备一些 UNIX 的基础知识；你应该知道文件系统是如何工作的，例如 <code>/home/users/pws/.zshrc</code> 和 <code>../file</code> 的含义，以及一些基本命令，例如 <code>ls</code>，并且你应该有过不小心用 <code>rm</code> 删错文件的经历，诸如此类。在类似 <code>rm file</code> 的命令中，我通常会提到 <code>command</code>（命令，这里当然是 <code>rm</code>）和 <code>argument(s)</code>（参数，即命令后被其使用的任何东西），以及你一次性输入的完整内容称为 <code>command line</code>（命令行）。</p>
<p>你还需要 zsh 本身；如果你正在阅读本文，你很可能已经有了，但如果你没有，你或你的系统管理员应该阅读<a href="zshguide08.html#appa">附录 A</a>。现在，我们假设你正坐在一台已经运行着 zsh 的终端前。</p>
<p>现在说到 shell。登录后，你可能会看到一些提示符（屏幕上表示你可以输入命令的一系列符号），例如 <code>$</code> 或 <code>%</code>，可能前面还有一些其他文本 --- 稍后，我们将看到如何以有趣的方式更改这些文本。那个提示符来自 shell。输入 <code>print hello</code>，然后用退格键删除 <code>hello</code> 并输入 <code>goodbye</code>。现在按下 <code>Return</code> 键（或 <code>Enter</code> 键，从现在起我将简称为 <code>&lt;RET&gt;</code>，同样 <code>&lt;TAB&gt;</code> 代表 Tab 键，<code>&lt;SPC&gt;</code> 代表空格键）；除非你的系统上有严重的恶作剧问题，否则你会看到 <code>goodbye</code>，然后 shell 会返回另一个提示符。在你按下 <code>&lt;RET&gt;</code> 之前的所有时间里，你都在与 shell 及其编辑器（称为 <code>Z-Shell Line Editor</code> 或简称 <code>zle</code>）进行交互；只有在那之后，shell 才去告诉 <code>print</code> 命令打印出一条消息。所以你可以看到 shell 是很重要的。</p>
<p>然而，如果你只是输入像那样的简单命令，为什么需要任何复杂的东西呢？在这种情况下，你不需要；但现实生活没那么简单。在本指南的其余部分，我将描述在 zsh 的帮助下，你如何能够：</p>
<ul>
<li>通过使用启动文件，自定义你的工作环境，</li>
<li>编写你自己的命令来缩短任务，并将东西存储在 shell 变量（<code>parameters</code>）中，这样你就不必记住它们，</li>
<li>使用 zle 来最小化你必须输入的量 --- 在 zsh 中，你甚至可以用这种方式编辑小文件，</li>
<li>使用 zsh 非常复杂的 文件名生成（俗称 <code>globbing</code>）系统，为你想要用于特定命令（如 <code>mv</code> 或 <code>ls</code>）的文件进行挑选，</li>
<li>告诉编辑器你对特定命令使用什么样的参数，这样你只需要输入名称的一部分，它就会使用 zsh 无与伦-</li>
<li>使用最新版 zsh 提供的额外附加组件（<code>modules</code>），来做一些你通常在 shell 中根本做不到的事情。</li>
</ul>
<p>这只是一个小小的样本。由于要说的东西太多，本指南将专注于 zsh做得最好的事情，特别是它拥有而其他 shell 没有的东西。下一章通过尝试解释如何按照你想要的方式设置 shell，来介绍一些基础知识。像本指南的其余部分一样，它不打算详尽无遗，要了解全部内容，你应该查阅 shell 手册。</p>
<p>还有一些你可能应该马上知道的事情。首先，shell 总是在运行，即使你输入的命令也在运行；shell 只是等待它完成：你可能从其他 shell 中知道，通过在命令后加上一个 <code>&amp;</code>，可以将命令放入<strong>后台</strong>，这意味着 shell 不会等待它们完成。即使命令在前台，shell 也在那里，只是在这种情况下什么也不做。</p>
<p>其次，它不只是运行别人的命令，它也有自己的一些命令，称为<strong>内建命令</strong>或简称<strong>builtins</strong>，你甚至可以添加自己的命令，作为给 shell 的指令列表，称为<strong>函数</strong>；内建命令和函数总是在 shell 自身内部运行。了解这一点很重要，因为不在 shell 自身内部运行的东西不能影响它，因此不能改变参数、函数、别名以及我将要讨论的所有其他东西。</p>
<p>[]{#l2}</p>
<h2 id="11-其他-shell-和其他指南"><a class="header" href="#11-其他-shell-和其他指南">1.1: 其他 shell 和其他指南</a></h2>
<p>如果你想对 shell 的工作原理、它们的语法（即如何编写命令）以及如何编写脚本和函数有一个基本的了解，你应该阅读关于这个主题的众多书籍之一。特别是，阅读一本描述 Korn shell (ksh) 的书会让你收获最多，因为 zsh 与它非常相似 --- 如此相似，以至于我在讲解过程中指出差异是值得的，因为它们可能会让 ksh 用户感到困惑。最近版本的 zsh 可以非常接近地模拟 ksh（严格来说是 1988 年版的 ksh，尽管越来越多地加入了 1993 年版的特性），虽然并不完美，而且你看得越仔细，就越不完美。然而，重要的是要认识到，如果你只是启动任何一个旧的 zsh，并不能保证它会被设置为像 ksh 一样工作；除非你或你的系统管理员更改了一些设置，否则它肯定不会。你可能不会马上看到这一点，但它会以微妙的方式影响 shell。我稍后会更多地讨论模拟。</p>
<p>还有一些其他的 shell 值得一提。所有 UNIX shell 的鼻祖是 sh，现在被称为 Bourne shell，但最初只被称为 <code>the shell</code>。情况与 ksh 类似：zsh 可以非常接近地模拟 sh（比模拟 ksh 更接近，因为 sh 要简单得多），但通常你需要确保它被设置为这样做，然后才能确定它会模拟 sh。</p>
<p>你可能还会遇到 <code>Bourne-Again Shell</code>，即 bash。这是 GNU 项目编写的 sh 的一个免费增强版 --- 但它并不总是沿着 ksh 的路线增强，因此在许多方面它与 zsh 非常不同。在一些免费的类 UNIX 系统上，例如 Linux/GNU（人们通常所说的 Linux），命令 sh 实际上是 bash，所以在那里，当你试图确保在所谓的 <code>sh</code> 下运行的东西也能在 zsh 下运行时，你应该格外小心。一些 Linux 系统还有另一个更简单的 Bourne shell 克隆，ash；因为它更简单，所以更像原始的 Bourne shell。</p>
<p>一些更现代的操作系统谈论 <code>POSIX shell</code>。这是对 UNIX shell 进行标准化的尝试；它最像 Korn shell，尽管有点令人困惑的是，它通常只被称为 sh，因为标准规定它应该如此。通常，这只意味着你的 sh 附带了一些额外的免费功能，并且仍然能如你所愿地工作。Zsh 已经做了一些尝试来符合标准，但你必须告诉它这样做 --- 同样，仅仅启动 <code>zsh</code> 并不会有正确的设置。</p>
<p>还有另一个常见的 shell 家族，不幸的是，它们的语法不兼容。这个家族的源头是 C-Shell，csh，之所以这么叫是因为它的语法更像 C 编程语言。当当时唯一可用的其他 shell 是 sh 时，csh 因为有更好的交互功能（如作业控制）而变得普及。后来它被增强为 tcsh，它具有许多你也会在 zsh 中找到的交互功能，因此变得非常流行。尽管有这些共同的特性，zsh 的语法却非常不同，所以你不应该在 zsh 中尝试使用除了最简单的 csh/tcsh 命令之外的命令；但如果你是 tcsh 用户，你会发现你习惯的几乎所有功能在 zsh 中都能找到，而且还有更多。</p>
<p>[]{#l3}</p>
<h2 id="12-zsh-的版本"><a class="header" href="#12-zsh-的版本">1.2: zsh 的版本</a></h2>
<p>在撰写本文时，可供广泛使用的最新 zsh 版本是 4.0.6。你通常会发现两套旧的 zsh。3.0 系列，其最后一个版本是 3.0.9，是一个稳定版本，自 zsh 3 的第一个版本发布以来只有错误修复。3.1 系列是 beta 版本，有很多新功能；其中最后一个版本 3.1.9 与 4.0.1 相差不大；主要的变化是 shell 现在已被宣布为稳定版，因此与 zsh 3 一样，将有一组错误修复，标记为 4.0，以及一组包含新功能的版本，标记为 4.1。由于 4.0 取代了所有 zsh 3 版本，我将尽量简化并只讨论 4.0；但偶尔指出旧版本的不同之处会很有帮助。</p>
<p>Zsh 的一个显著特点是命令行参数的补全。该系统在 3.1.6 和 3.1.7 中发生了变化，使其更具可配置性，并且（只要你保持清醒）稍微不那么晦涩。因此，我不会详细描述旧的补全系统，它使用 <code>compctl</code> 命令；zsh FAQ 中有一个非常简短的介绍。旧系统仍然可用，但我们强烈建议新用户从新系统开始。有关新式补全的详细信息，请参见<a href="zshguide06.html#comp">第六章</a> <code>补全，旧与新</code>。</p>
<p>4.0 和 4.1 之间不会有太大差异，只是一些错误修复和一些演进性变化，外加一些额外的模块。在<a href="zshguide07.html#ragbag">第七章</a>中会有一些关于 4.1 新功能的说明，但你为 4.0 编写的任何东西在可预见的未来都不太可能过时。</p>
<p>[]{#l4}</p>
<h2 id="13-约定"><a class="header" href="#13-约定">1.3: 约定</a></h2>
<p>我所说的大部分内容都将是相当独立的（这意味着我使用的短语如 <code>如我之前所说</code> 和 <code>我稍后会讨论</code> 比真正的文体家希望的要多，而且我引用其他章节的次数也过多），但在你深入之前，我可能应该提请你注意一些要点。</p>
<p>我经常会像你在文件中编写可执行代码（<code>脚本</code> 或 <code>函数</code>，差异将在各处讨论）那样写代码块：</p>
<pre><code>  if [[ $ZSH_VERSION = 3.* ]]; then
    print This is a release of the third version of zsh.
  else
    print This is either very new or very old.
  fi
</code></pre>
<p>但有时我会同时显示你在 shell 中交互式输入的内容，以及 shell 返回给你的内容：</p>
<pre><code>  % print $ZSH_VERSION
  3.1.9
  % print $CPUTYPE
  i586
</code></pre>
<p>在这里，<code>%</code> 显示了 shell 提示符，告诉你它正在等待输入（紧随其后的空格是它的一部分）。实际上，你可能会在百分号前看到一些东西，比如机器名或你的用户名，或者更花哨的东西。为了避免混淆，我把它精简到了最低限度，并保留它作为提醒，这是你输入的那一行。</p>
<p>如果你正在阅读本指南的电子版，并想将前面带有 <code>%</code> 的行复制到终端中执行，有一个巧妙的方法，你甚至不必先编辑该行：</p>
<pre><code>  alias %=' '
</code></pre>
<p>然后，行首的 <code>%</code> 会变成空无一物；空格只是表示任何后续的别名都应该被展开。所以 <code> % print $CPUTYPE</code> 这一行会忽略 <code>%</code> 并执行该行的其余部分。（我希望这很明显，但你<em>自己的</em>提示符总是被忽略的；这只是在你从指南中复制提示符到 shell 中时才适用。）</p>
<p>Zsh 中有许多不同类型的对象，但最常见的一种是参数，我将始终在它们前面加上 <code>$</code> 符号，如 <code>$ZSH_VERSION</code>，以提醒你它们是参数。你需要记住，当你设置或操作参数本身而不是其值时，你要省略 <code>$</code>。随着我们的深入，何时需要何时不需要它应该会变得更清楚。</p>
<p>我将特别展示的另一类对象是 shell 选项 --- 关于 shell 如何工作的选择 --- 我会这样写：<code>SH_WORD_SPLIT</code>、<code>NO_NOMATCH</code>、<code>ZLE</code>。同样，这也不是全部，因为只要 shell 期望选项，你就可以用大写或小写字母书写它们，下划线的数量也可以随意；而且在代码块中，我通常会使用最简单的形式：<code>shwordsplit</code>、<code>nonomatch</code>、<code>zle</code>。如果你有哲学头脑，可以认为这是在表达谈论编程和实际编程之间的类别差异，但实际上只是我前后不一致而已。</p>
<p>你可能会觉得我用三个连字符来表示一个破折号很奇怪。这实际上是本指南印刷版中使用的一个约定，它是用 LaTeX 制作的。总有一天，我会把它变成一个宏，它会在其他版本中正确显示；但是，总有一天宇宙也会终结。</p>
<p>[]{#l5}</p>
<h2 id="14-致谢"><a class="header" href="#14-致谢">1.4: 致谢</a></h2>
<p>我感谢各位 zsh 用户的评论。特别是，我收到了来自 Bart Schaefer、Sven <code>Mr Completion</code> Wischnowsky 和 Oliver Kiddle 的详细评论和更正。通常会加上一句“任何剩余的错误都是我自己的”，但这简直是显而易见到了荒谬的地步。我的意思是，这是谁写的？算了。</p>
<p>大部分内容是在某个版本的 Linux Mandrake（Red Hat 的一个衍生版）上，使用通常的 GNU 和 XFree86 工具编写的。由于所有这些都是免费的，说声 <code>谢谢</code> 以示感谢似乎是公平的。它也比这台特定 PC 自带的操作系统好用得多。</p>
<hr />
<ul>
<li><a href="zshguide.html">目录</a></li>
<li><a href="zshguide02.html">下一章</a></li>
</ul>
<hr />

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="zshguide.cn.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="zshguide02.cn.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="zshguide.cn.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="zshguide02.cn.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>

        <!-- Livereload script (if served using the cli tool) -->
        <script>
            const wsProtocol = location.protocol === 'https:' ? 'wss:' : 'ws:';
            const wsAddress = wsProtocol + "//" + location.host + "/" + "__livereload";
            const socket = new WebSocket(wsAddress);
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload();
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>



        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
